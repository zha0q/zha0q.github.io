---
title: js基础进阶笔记
author: zq
date: 2021-10-24
category: contest
layout: post
---

### js基础进阶笔记

##### 一、内存空间

1. js执行上下文生成后，会创建名为变量对象的一种特殊对象，js基础数据类型都会保存在变量对象中。

2. 与其它语言不同，js引用数据类型的值大小是不固定的。**引用数据类型的值**是保存在堆内存中的对象。js不允许直接访问堆内存中的位置，因此我们不能直接操作对象的堆内存空间，在操作对象时，实际上是在操作对象的引用而不是实际的对象。

3. js有自动垃圾回收机制，使用**标记清除**算法，`a = null`仅仅做了释放引用操作，脱离执行环境，让其在下一次垃圾收集器执行操作时被找到并释放 **在局部作用域中，函数执行完毕局部变量就没有存在必要，垃圾收集器很容易做出判断并回收，但全局变量很难判断，因此要尽量少用全局变量** 



##### 二、执行上下文

1. 当控制器转到可执行代码时，就会进入执行上下文，可以将其理解为当前代码的执行环境，他会形成一个作用域，一个js程序一定会有多个执行上下文，js引擎会以栈的方式调用他们，栈底永远是全局上下文，栈顶为当前正在执行上下文。

##### 三、变量对象

1. 一个执行上下文周期分为两个阶段：

   - **创建阶段** 在这个阶段中，执行上下文会分别创建变量对象，建立作用域链，以及确定this的指向。

   - **代码执行阶段** 创建完成之后，就会开始执行代码，这个时候，会完成变量赋值，函数引用，以及执行其他代码。
   
     **执行上下文定义了一个函数的执行环境**

2. 变量对象的创建，依次经历了以下几个过程。
   1. 建立arguments对象。检查当前上下文中的参数，建立该对象下的属性与属性值。
   2. 检查当前上下文的函数声明，也就是使用function关键字声明的函数。在变量对象中以函数名建立一个属性，属性值为指向该函数所在内存地址的引用。如果函数名的属性已经存在，那么该属性将会被新的引用所覆盖。
   3. 检查当前上下文中的变量声明，每找到一个变量声明，就在变量对象中以变量名建立一个属性，属性值为undefined。如果该变量名的属性已经存在，为了防止同名的函数被修改为undefined，则会直接跳过，原属性值不会被修改。

##### 四、作用域链(scope chain)与闭包

1. 作用域链就是函数中scpoe属性所存储的执行期上下文对象的集合，集合呈链式链接，所以叫做作用域链，我们可以在这个单向通道中，查询变量对象中的标识符，这样就可以访问到上一层作用域中的变量了。

2. **闭包是一种特殊的对象。**

   **它由两部分组成。执行上下文(代号A)，以及在该执行上下文中创建的函数（代号B）。**

   **当B执行时，如果访问了A中变量对象中的值，那么闭包就会产生。**

